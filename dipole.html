
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Relaxing an Al (1 1 1) surface under an electric field using SPHInX &#8212; pyiron_generalized_dipole</title>
    
  <link rel="stylesheet" href="_static/css/index.f658d18f9b420779cfdf24aa0a7e2d77.css">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/sphinx-book-theme.37f24b989f4638ff9c27c22dc7559d4f.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.d3f166471bb80abb5163.js">

    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.7d483ff0a819d6edff12ce0b1ead3928.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="pyiron_generalized_dipole" href="README.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="index.html">
  
  <img src="_static/logo_dark.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">pyiron_generalized_dipole</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="README.html">
   pyiron_generalized_dipole
  </a>
 </li>
</ul>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Relaxing an Al (1 1 1) surface under an electric field using SPHInX
  </a>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://pyiron.org">pyiron</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/dipole.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->


            <!-- Full screen (wrap in <a> to have style consistency -->
            <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                    data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                    title="Fullscreen mode"><i
                        class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/pyiron/pyiron_generalized_dipole/master?urlpath=lab/tree/dipole.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#create-the-job">
   Create the job
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#build-an-al-1-1-1-surface-and-assign-it-to-the-job">
   Build an Al (1 1 1) surface and assign it to the job
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#freeze-the-bottom-half-of-the-slab">
   Freeze the bottom half of the slab
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#set-up-the-dft-input-for-a-basic-geometry-optimization">
   Set up the DFT input for a basic geometry optimization
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#modify-energy-cutoff-and-k-points-for-a-surface-calculation">
   Modify energy cutoff and k-points for a surface calculation
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#charge-the-bottom-layer-of-atoms">
   Charge the bottom layer of atoms
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#add-the-dipole-correction-to-the-pawhamiltonian-group">
   Add the dipole correction to the PAWHamiltonian group
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#run-the-job">
   Run the job
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#plot-the-electrostatic-potential">
   Plot the electrostatic potential
  </a>
 </li>
</ul>

        </nav>
        
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="relaxing-an-al-1-1-1-surface-under-an-electric-field-using-sphinx">
<h1>Relaxing an Al (1 1 1) surface under an electric field using SPHInX<a class="headerlink" href="#relaxing-an-al-1-1-1-surface-under-an-electric-field-using-sphinx" title="Permalink to this headline">Â¶</a></h1>
<p>If you make use of this notebook and/or its recipes, please consider citing the following (for which this notebook has been distributed as supporting material):</p>
<blockquote>
<div><p>Christoph Freysoldt, Arpit Mishra, Michael Ashton, and JÃ¶rg Neugebauer, <em>Generalized dipole correction for charged surfaces in the repeated-slab approach</em>, Phys. Rev. B <strong>102</strong>, 045403</p>
</div></blockquote>
<p>The goal of this notebook is to give a very simple example for using the generalized dipole correction (outlined in detail within the above paper) within the <a class="reference external" href="https://sxrepo.mpie.de">SPHInX</a> DFT program.</p>
<p>As one of the simplest use cases, we will add an electric field to both sides of a very thin Al (111) slab and relax the slab. The electric potential in the DFT cell will be plotted at the end of the notebook so you can visualize the generalized dipole correction as it is described in the paper.</p>
<p>The calculations and analysis are performed using <a class="reference external" href="https://pyiron.org">pyiron</a>. For more details on specific commands/options in pyiron or SPHInX, please consult their individual documentation and tutorials.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyiron</span> <span class="kn">import</span> <span class="n">Project</span>
<span class="kn">from</span> <span class="nn">pyiron_atomistics.sphinx.base</span> <span class="kn">import</span> <span class="n">Group</span>

<span class="kn">import</span> <span class="nn">os</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">import</span> <span class="nn">matplotlib.pylab</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="create-the-job">
<h2>Create the job<a class="headerlink" href="#create-the-job" title="Permalink to this headline">Â¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pr</span> <span class="o">=</span> <span class="n">Project</span><span class="p">(</span><span class="s2">&quot;ChargedRelax&quot;</span><span class="p">)</span>
<span class="n">job</span> <span class="o">=</span> <span class="n">pr</span><span class="o">.</span><span class="n">create_job</span><span class="p">(</span>
    <span class="n">job_type</span><span class="o">=</span><span class="n">pr</span><span class="o">.</span><span class="n">job_type</span><span class="o">.</span><span class="n">Sphinx</span><span class="p">,</span>
    <span class="n">job_name</span><span class="o">=</span><span class="s2">&quot;Al_111&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="build-an-al-1-1-1-surface-and-assign-it-to-the-job">
<h2>Build an Al (1 1 1) surface and assign it to the job<a class="headerlink" href="#build-an-al-1-1-1-surface-and-assign-it-to-the-job" title="Permalink to this headline">Â¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">job</span><span class="o">.</span><span class="n">structure</span> <span class="o">=</span> <span class="n">pr</span><span class="o">.</span><span class="n">create_surface</span><span class="p">(</span><span class="s2">&quot;Al&quot;</span><span class="p">,</span> <span class="s2">&quot;fcc111&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span> <span class="n">vacuum</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">job</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">add_tag</span><span class="p">(</span><span class="n">selective_dynamics</span><span class="o">=</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">job</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">plot3d</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "fdb49eda1ce64002b2882c2e8930210f"}
</script><script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "9566ca88f97b4654855b12ac030f8e42"}
</script></div>
</div>
</div>
<div class="section" id="freeze-the-bottom-half-of-the-slab">
<h2>Freeze the bottom half of the slab<a class="headerlink" href="#freeze-the-bottom-half-of-the-slab" title="Permalink to this headline">Â¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">job</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">selective_dynamics</span><span class="p">[</span>
    <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">job</span><span class="o">.</span><span class="n">structure</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span><span class="p">)</span>
<span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="set-up-the-dft-input-for-a-basic-geometry-optimization">
<h2>Set up the DFT input for a basic geometry optimization<a class="headerlink" href="#set-up-the-dft-input-for-a-basic-geometry-optimization" title="Permalink to this headline">Â¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">job</span><span class="o">.</span><span class="n">calc_minimize</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="modify-energy-cutoff-and-k-points-for-a-surface-calculation">
<h2>Modify energy cutoff and k-points for a surface calculation<a class="headerlink" href="#modify-energy-cutoff-and-k-points-for-a-surface-calculation" title="Permalink to this headline">Â¶</a></h2>
<p>Feel free to use lower settings to get the calculation to run faster on MyBinder, which is a free-to-use server!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">job</span><span class="o">.</span><span class="n">set_encut</span><span class="p">(</span><span class="mi">400</span><span class="p">)</span>  <span class="c1"># in eV</span>
<span class="n">job</span><span class="o">.</span><span class="n">set_kpoints</span><span class="p">([</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">center_shift</span><span class="o">=</span><span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="charge-the-bottom-layer-of-atoms">
<h2>Charge the bottom layer of atoms<a class="headerlink" href="#charge-the-bottom-layer-of-atoms" title="Permalink to this headline">Â¶</a></h2>
<p>In this case, we are targeting a specific field on the right and left sides of the slab (<code class="docutils literal notranslate"><span class="pre">right_field</span></code> and <code class="docutils literal notranslate"><span class="pre">left_field</span></code>, respectively). The following cell calculates the charge required to create this field and then distributes this charge evenly across all âbottomâ (leftmost) atoms of the slab for the initial density.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">HARTREE_TO_EV</span> <span class="o">=</span> <span class="mf">27.2114</span>
<span class="n">ANGSTROM_TO_BOHR</span> <span class="o">=</span> <span class="mf">1.8897</span>

<span class="c1"># atomic units (1 E_h/ea_0 ~= 51.4 V/Ã)</span>
<span class="n">right_field</span> <span class="o">=</span> <span class="mf">0.05</span>
<span class="n">left_field</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.025</span>

<span class="n">cell</span> <span class="o">=</span> <span class="n">job</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">cell</span> <span class="o">*</span> <span class="n">ANGSTROM_TO_BOHR</span>
<span class="n">area</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cross</span><span class="p">(</span><span class="n">cell</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">cell</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>

<span class="n">total_charge</span> <span class="o">=</span> <span class="p">(</span><span class="n">right_field</span> <span class="o">-</span> <span class="n">left_field</span><span class="p">)</span> <span class="o">*</span> <span class="n">area</span> <span class="o">/</span> <span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="c1"># Eqn. 3 from Freysoldt, et al.</span>

<span class="n">positions</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">job</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">positions</span><span class="p">]</span>
<span class="n">job</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">sphinx</span><span class="o">.</span><span class="n">initialGuess</span><span class="o">.</span><span class="n">rho</span><span class="o">.</span><span class="n">charged</span> <span class="o">=</span> <span class="n">Group</span><span class="p">({})</span>
<span class="n">job</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">sphinx</span><span class="o">.</span><span class="n">initialGuess</span><span class="o">.</span><span class="n">rho</span><span class="o">.</span><span class="n">charged</span><span class="o">.</span><span class="n">charge</span> <span class="o">=</span> <span class="n">total_charge</span>
<span class="n">job</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">sphinx</span><span class="o">.</span><span class="n">initialGuess</span><span class="o">.</span><span class="n">rho</span><span class="o">.</span><span class="n">charged</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">positions</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="add-the-dipole-correction-to-the-pawhamiltonian-group">
<h2>Add the dipole correction to the PAWHamiltonian group<a class="headerlink" href="#add-the-dipole-correction-to-the-pawhamiltonian-group" title="Permalink to this headline">Â¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">z_field</span></code> parameter in the <code class="docutils literal notranslate"><span class="pre">PAWHamiltonian</span></code> input group controls the âexcessâ field that should remain on the other side of the dipole correction layer, i.e. the field that will exist on the bottom (left) side of the slab.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">job</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">sphinx</span><span class="o">.</span><span class="n">PAWHamiltonian</span><span class="o">.</span><span class="n">nExcessElectrons</span> <span class="o">=</span> <span class="o">-</span><span class="n">total_charge</span>
<span class="n">job</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">sphinx</span><span class="o">.</span><span class="n">PAWHamiltonian</span><span class="o">.</span><span class="n">dipoleCorrection</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">job</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">sphinx</span><span class="o">.</span><span class="n">PAWHamiltonian</span><span class="o">.</span><span class="n">zField</span> <span class="o">=</span> <span class="n">left_field</span> <span class="o">*</span> <span class="n">HARTREE_TO_EV</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="run-the-job">
<h2>Run the job<a class="headerlink" href="#run-the-job" title="Permalink to this headline">Â¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">job</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">run_again</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;ipython-input-10-ae9f2db87acf&gt;:1: DeprecationWarning: pyiron_base.job.generic.run(run_again=True) is deprecated. It is not guaranteed to be in service in vers. 0.4.0
  job.run(run_again=True)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The job Al_111 was saved and received the ID: 1
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="plot-the-electrostatic-potential">
<h2>Plot the electrostatic potential<a class="headerlink" href="#plot-the-electrostatic-potential" title="Permalink to this headline">Â¶</a></h2>
<p>Uncomment the commented lines to plot the expected fields on top of the potential.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">v_electrostatic</span> <span class="o">=</span> <span class="n">job</span><span class="o">.</span><span class="n">get_electrostatic_potential</span><span class="p">()</span>
<span class="n">planar_avg</span> <span class="o">=</span> <span class="n">v_electrostatic</span><span class="o">.</span><span class="n">get_average_along_axis</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">job</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">cell</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span> <span class="nb">len</span><span class="p">(</span><span class="n">planar_avg</span><span class="p">))</span>

<span class="c1"># ind_0 = np.argwhere(x &gt; 9)[0]</span>
<span class="c1"># ind_dipole = np.argmax((2 * planar_avg - np.roll(planar_avg, 1) - np.roll(planar_avg, -1))[np.abs(x - 12) &lt; 3]) + ind_0</span>
<span class="c1"># m_dipole = x[ind_dipole+1]</span>

<span class="c1"># E_right = right_field * 51.4 * (x - m_dipole) + planar_avg[ind_dipole]</span>
<span class="c1"># E_left = left_field * 51.4 * (x - m_dipole) + planar_avg[ind_dipole + 1]</span>

<span class="c1"># plt.axvline(m_dipole, color=&quot;k&quot;)</span>
<span class="c1"># plt.plot(x, E_right, &#39;k--&#39;)</span>
<span class="c1"># plt.plot(x, E_left, &#39;k--&#39;)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">planar_avg</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;$z$ [Ã]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Potential [eV]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/dipole_21_0.png" src="_images/dipole_21_0.png" />
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
        <div class='prev-next-bottom'>
            
    <a class='left-prev' id="prev-link" href="README.html" title="previous page">pyiron_generalized_dipole</a>

        </div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By pyiron<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="_static/js/index.d3f166471bb80abb5163.js"></script>


    
  </body>
</html>